<h1>イベント会場詳細</h1>

<table>
  <tv>
    <div><%= attachment_image_tag @event, :image, :fill, 600,600, fallback: "no_image.jpg" %></div>
    <div>
      <label>イベント会場名</label><%= @event.eventname %>
      <label>住所</label><%= @event.address %>
      <label>サイトURL</label><%= link_to @event.siteurl, @event.siteurl %>
      <label>イベント会場概要欄</label><%= @event.comment %>
    </div>
  </tr>
</table>

<div id="target"></div>
<!--div id="address" value=<%#= @event.address %>></div-->
<!--input id="address" value="<%#= @event.address %>"-->
<input id="address" type="hidden" value="<%= @event.address %>">
<!--input type="button" value="検索" onclick="codeAddress()"-->
<style>#target {height: 600px;width: 600px;}</style>
<div>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['MAP_API_KEY']%>&callback=initMap" async defer></script>

<% if user_signed_in? %>
  <% if @event.favorited_by?(current_user) %>
    <p>
      <%= link_to publics_event_favorites_path(@event), method: :delete do %>
        ♥<%= @event.favorites.count %> いいね
      <% end %>
    </p>
    <% else %>
    <p>
      <%= link_to publics_event_favorites_path(@event), method: :post do %>
        ♡<%= @event.favorites.count %> いいね
      <% end %>
    </p>
  <% end %>
  <div>
    <% @event.event_comments.each do |event_comment| %>
      <%= event_comment.eventcomment %>
    <% end %>
  </div>
  <%= form_with model:@event_comment, url:publics_event_event_comments_path(@event),remote: true do |f| %> 
    <div class="form-group">
      <div class="field_with_errors">
        <label for="event_title">Comment</label>
      </div>
      <%= f.text_area :eventcomment %>
    </div>
    <div class="form-group">
      <%= f.submit '送信', class: "btn btn-success" %>
    </div>
  <% end %>
  <%= link_to '編集', edit_publics_event_path(@event) %>
<% else %>
  <%= @event.favorites.count %> いいね
  <% @event.event_comments.each do |event_comment| %>
    <%= event_comment.eventcomment %>
  <% end %>
<% end %>
